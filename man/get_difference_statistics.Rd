% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_difference_statistics.R
\name{get_difference_statistics}
\alias{get_difference_statistics}
\title{Compute Pairwise Difference Statistics}
\usage{
get_difference_statistics(estimate, vcov, df = NULL, method = "none")
}
\arguments{
\item{estimate}{numeric vector of parameter estimates. estimates must be a
named vector if vcov has no row or column names. Names are
used for labeling the output matrices.}

\item{vcov}{Variance-covariance matrix of the estimates. Must be symmetric
with dimensions matching the length of \code{estimate}.}

\item{df}{Degrees of freedom for t-distribution. If NULL (default),
normal distribution (z-test) is used.}

\item{method}{Multiple testing correction method. Must be one of:
"none" (default), "holm", "hochberg", "hommel", "bonferroni",
"BH", "BY", "fdr". See \code{\link[stats]{p.adjust}} for details.}
}
\value{
A list with four components:
\describe{
\item{difference}{Matrix of pairwise differences (estimate[i] - estimate[j])}
\item{vcov}{Matrix of variances for each pairwise difference}
\item{P_values}{Matrix of two-sided p-values (adjusted if method != "none")}
\item{method}{Character string indicating the correction method used}
}
All matrices have row and column names matching the names of \code{estimate}.
Diagonal elements represent comparisons of estimates with themselves.
}
\description{
Calculates pairwise differences between estimates, their variances,
test statistics, and p-values. Useful for post-hoc comparisons in
statistical models.
}
\details{
This function performs pairwise comparisons between all estimates by:
\enumerate{
\item Computing all pairwise differences: \code{estimate[i] - estimate[j]}
\item Computing variance of each difference using the variance-covariance matrix
\item Computing test statistics (z-scores or t-statistics)
\item Computing two-sided p-values
\item Optionally applying multiple testing correction
}

\strong{Variance of Differences:}
The variance of a difference between two estimates is computed as:
\deqn{Var(X_i - X_j) = Var(X_i) + Var(X_j) - 2 \times Cov(X_i, X_j)}

\strong{Test Statistic:}
For each pairwise difference:
\deqn{z = \frac{difference}{\sqrt{Var(difference)}}}

If \code{df} is provided, t-statistics are used instead of z-statistics.

\strong{Multiple Testing Correction:}
When \code{method != 'none'}, p-values are adjusted using the specified
method (see \code{\link[stats]{p.adjust}}). Only the lower triangle
(unique comparisons) is adjusted, then mirrored to upper triangle.
}
\note{
\strong{Important considerations:}
\itemize{
\item Diagonal elements of difference matrix are always 0
\item Diagonal elements of P_values matrix are always 1
\item The difference matrix is antisymmetric: \code{diff[i,j] = -diff[j,i]}
\item Near-zero values are set to exact zero using \code{set_zero()}
}

\strong{Multiple Testing:}
When comparing k estimates, there are k*(k-1)/2 unique pairwise comparisons.
Multiple testing correction accounts for this to control family-wise error
rate or false discovery rate.
}
\examples{
# Example with 3 estimates
est <- c(A = 10, B = 12, C = 15)
V <- matrix(c(
  1.0, 0.2, 0.1,
  0.2, 1.5, 0.3,
  0.1, 0.3, 2.0
), nrow = 3, byrow = TRUE)

# Without multiple testing correction
result <- get_difference_statistics(est, V)
result$difference  # Pairwise differences
result$P_values    # Unadjusted p-values

# With Bonferroni correction
result_bonf <- get_difference_statistics(est, V, method = "bonferroni")
result_bonf$P_values  # Bonferroni-adjusted p-values

# With t-distribution (df = 20)
result_t <- get_difference_statistics(est, V, df = 20)

}
\seealso{
\code{\link[stats]{p.adjust}} for multiple testing correction methods
\code{\link{set_zero}} for handling near-zero values
}
